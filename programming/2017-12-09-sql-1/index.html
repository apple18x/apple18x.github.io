<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="SQL," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="以下为 MYSQL 数据库的语法，部分不适用于其他数据库。 数据类型在 MySQL 中，有三种主要的类型：文本、数字和日期/时间类型。">
<meta name="keywords" content="SQL">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL 基础（一）">
<meta property="og:url" content="http://www.xinxiaoyang/programming/2017-12-09-sql-1/index.html">
<meta property="og:site_name" content="昕小阳的博客">
<meta property="og:description" content="以下为 MYSQL 数据库的语法，部分不适用于其他数据库。 数据类型在 MySQL 中，有三种主要的类型：文本、数字和日期/时间类型。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://www.xinxiaoyang/programming/2017-12-09-sql-1/sql-1.png">
<meta property="og:updated_time" content="2018-01-02T14:44:53.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SQL 基础（一）">
<meta name="twitter:description" content="以下为 MYSQL 数据库的语法，部分不适用于其他数据库。 数据类型在 MySQL 中，有三种主要的类型：文本、数字和日期/时间类型。">
<meta name="twitter:image" content="http://www.xinxiaoyang/programming/2017-12-09-sql-1/sql-1.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://www.xinxiaoyang/programming/2017-12-09-sql-1/"/>


  <title> SQL 基础（一） | 昕小阳的博客 </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-99363578-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">昕小阳的博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">故事我有，我不喝酒。</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                SQL 基础（一）
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-12-09T00:00:00+08:00" content="2017-12-09">
              2017-12-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/programming/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>以下为 MYSQL 数据库的语法，部分不适用于其他数据库。</p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p>在 MySQL 中，有三种主要的类型：文本、数字和日期/时间类型。</p>
<a id="more"></a>
<p>Text 类型</p>
<table>
<thead>
<tr>
<th style="text-align:left">数据类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">CHAR(size)</td>
<td style="text-align:left">保存固定长度的字符串（可包含字母、数字以及特殊字符）。在括号中指定字符串的长度。最多 255 个字符。</td>
</tr>
<tr>
<td style="text-align:left">VARCHAR(size)</td>
<td style="text-align:left">保存可变长度的字符串（可包含字母、数字以及特殊字符）。在括号中指定字符串的最大长度。最多 255 个字符。<br>注释：如果值的长度大于 255，则被转换为 TEXT 类型。</td>
</tr>
<tr>
<td style="text-align:left">TINYTEXT</td>
<td style="text-align:left">存放最大长度为 255 个字符的字符串。</td>
</tr>
<tr>
<td style="text-align:left">TEXT</td>
<td style="text-align:left">存放最大长度为 65,535 个字符的字符串。</td>
</tr>
<tr>
<td style="text-align:left">BLOB</td>
<td style="text-align:left">用于 BLOBs (Binary Large OBjects)。存放最多 65,535 字节的数据。</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMTEXT</td>
<td style="text-align:left">存放最大长度为 16,777,215 个字符的字符串。</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMBLOB</td>
<td style="text-align:left">用于 BLOBs (Binary Large OBjects)。存放最多 16,777,215 字节的数据。</td>
</tr>
<tr>
<td style="text-align:left">LONGTEXT</td>
<td style="text-align:left">存放最大长度为 4,294,967,295 个字符的字符串。</td>
</tr>
<tr>
<td style="text-align:left">LONGBLOB</td>
<td style="text-align:left">用于 BLOBs (Binary Large OBjects)。存放最多 4,294,967,295 字节的数据。</td>
</tr>
<tr>
<td style="text-align:left">ENUM(x,y,z,etc.)</td>
<td style="text-align:left">允许你输入可能值的列表。可以在 ENUM 列表中列出最大 65535 个值。如果列表中不存在插入的值，则插入空值。<br>注释：这些值是按照你输入的顺序存储的。可以按照此格式输入可能的值：ENUM(‘X’,’Y’,’Z’)</td>
</tr>
<tr>
<td style="text-align:left">SET</td>
<td style="text-align:left">与 ENUM 类似，SET 最多只能包含 64 个列表项，不过 SET 可存储一个以上的值。</td>
</tr>
</tbody>
</table>
<p>Number 类型</p>
<table>
<thead>
<tr>
<th style="text-align:left">数据类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">TINYINT(size)</td>
<td style="text-align:left">-128 到 127 常规。0 到 255 无符号*。在括号中规定最大位数。</td>
</tr>
<tr>
<td style="text-align:left">SMALLINT(size)</td>
<td style="text-align:left">-32768 到 32767 常规。0 到 65535 无符号*。在括号中规定最大位数。</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMINT(size)</td>
<td style="text-align:left">-8388608 到 8388607 普通。0 to 16777215 无符号*。在括号中规定最大位数。</td>
</tr>
<tr>
<td style="text-align:left">INT(size)</td>
<td style="text-align:left">-2147483648 到 2147483647 常规。0 到 4294967295 无符号*。在括号中规定最大位数。</td>
</tr>
<tr>
<td style="text-align:left">BIGINT(size)</td>
<td style="text-align:left">-9223372036854775808 到 9223372036854775807 常规。0 到 18446744073709551615 无符号*。在括号中规定最大位数。</td>
</tr>
<tr>
<td style="text-align:left">FLOAT(size,d)</td>
<td style="text-align:left">带有浮动小数点的小数字。在括号中规定最大位数。在 d 参数中规定小数点右侧的最大位数。</td>
</tr>
<tr>
<td style="text-align:left">DOUBLE(size,d)</td>
<td style="text-align:left">带有浮动小数点的大数字。在括号中规定最大位数。在 d 参数中规定小数点右侧的最大位数。</td>
</tr>
<tr>
<td style="text-align:left">DECIMAL(size,d)</td>
<td style="text-align:left">作为字符串存储的 DOUBLE 类型，允许固定的小数点。</td>
</tr>
</tbody>
</table>
<p>注：这些整数类型拥有额外的选项 UNSIGNED。通常，整数可以是负数或正数。如果添加 UNSIGNED 属性，那么范围将从 0 开始，而不是某个负数。</p>
<p>Date 类型</p>
<table>
<thead>
<tr>
<th style="text-align:left">数据类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">DATE()</td>
<td style="text-align:left">日期。格式：YYYY-MM-DD<br>注释：支持的范围是从 ‘1000-01-01’ 到 ‘9999-12-31’</td>
</tr>
<tr>
<td style="text-align:left">DATETIME()</td>
<td style="text-align:left">*日期和时间的组合。格式：YYYY-MM-DD HH:MM:SS<br>注释：支持的范围是从 ‘1000-01-01 00:00:00’ 到 ‘9999-12-31 23:59:59’</td>
</tr>
<tr>
<td style="text-align:left">TIMESTAMP()</td>
<td style="text-align:left">*时间戳。TIMESTAMP 值使用 Unix 纪元(‘1970-01-01 00:00:00’ UTC) 至今的描述来存储。格式：YYYY-MM-DD HH:MM:SS<br>注释：支持的范围是从 ‘1970-01-01 00:00:01’ UTC 到 ‘2038-01-09 03:14:07’ UTC</td>
</tr>
<tr>
<td style="text-align:left">TIME()</td>
<td style="text-align:left">时间。格式：HH:MM:SS 注释：支持的范围是从 ‘-838:59:59’ 到 ‘838:59:59’</td>
</tr>
<tr>
<td style="text-align:left">YEAR()</td>
<td style="text-align:left">2 位或 4 位格式的年。<br>注释：4 位格式所允许的值：1901 到 2155。2 位格式所允许的值：70 到 69，表示从 1970 到 2069。</td>
</tr>
</tbody>
</table>
<p>注：即便 DATETIME 和 TIMESTAMP 返回相同的格式，它们的工作方式很不同。在 INSERT 或 UPDATE 查询中，TIMESTAMP 自动把自身设置为当前的日期和时间。TIMESTAMP 也接受不同的格式，比如 YYYYMMDDHHMMSS、YYMMDDHHMMSS、YYYYMMDD 或 YYMMDD。</p>
<h2 id="操作数据库"><a href="#操作数据库" class="headerlink" title="操作数据库"></a>操作数据库</h2><h3 id="CREATE-创建数据库"><a href="#CREATE-创建数据库" class="headerlink" title="CREATE 创建数据库"></a>CREATE 创建数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE 数据库名称</span><br></pre></td></tr></table></figure>
<h3 id="SHOW-查看数据库"><a href="#SHOW-查看数据库" class="headerlink" title="SHOW 查看数据库"></a>SHOW 查看数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 查看所有数据库</span><br><span class="line">SHOW DATABASES;</span><br><span class="line"></span><br><span class="line">// 查看用户当前打开的数据库</span><br><span class="line">SELECT DATABASE()</span><br></pre></td></tr></table></figure>
<h3 id="USE-打开数据库"><a href="#USE-打开数据库" class="headerlink" title="USE 打开数据库"></a>USE 打开数据库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE 数据库名称</span><br></pre></td></tr></table></figure>
<h2 id="操作数据表"><a href="#操作数据表" class="headerlink" title="操作数据表"></a>操作数据表</h2><p>在数据表中，行被称为“记录”，列称为“字段”。</p>
<h3 id="创建索引"><a href="#创建索引" class="headerlink" title="创建索引"></a>创建索引</h3><p>CREATE INDEX 语句用于在表中创建索引。<br>在不读取整个表的情况下，索引使数据库应用程序可以更快地查找数据。<br>注释：更新一个包含索引的表需要比更新一个没有索引的表更多的时间，这是由于索引本身也需要更新。因此，理想的做法是仅仅在常常被搜索的列（以及表）上面创建索引。</p>
<p>创建表时，可以用 KEY 关键词来创建索引：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名称</span><br><span class="line">(</span><br><span class="line">  列名称 数据类型,</span><br><span class="line">  ...</span><br><span class="line">  KEY (列名称)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>如果表已经存在，则使用 CREATE 关键字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE INDEX 索引名称 ON 表名称 (列名称)</span><br></pre></td></tr></table></figure>
<p>CREATE UNIQUE INDEX 表示创建唯一的索引。唯一的索引意味着两个行不能拥有相同的索引值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE UNIQUE INDEX 索引名称 ON 表名称 (列名称)</span><br></pre></td></tr></table></figure>
<h3 id="创建-VIEW"><a href="#创建-VIEW" class="headerlink" title="创建 VIEW"></a>创建 VIEW</h3><p>VIEW（视图）是基于 SQL 语句的结果集的可视化的表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 创建视图</span><br><span class="line">CREATE VIEW 视图名称 AS SELECT 列名称 FROM 表名称 WHERE 表达式</span><br><span class="line"></span><br><span class="line">// 使用视图</span><br><span class="line">SELECT * FROM 视图名称</span><br><span class="line"></span><br><span class="line">// 更新视图</span><br><span class="line">CREATE OR REPLACE VIEW 视图名称 AS SELECT 列名称1, [列名称2 ...] FROM 表名称 WHERE 表达式</span><br><span class="line"></span><br><span class="line">// 删除</span><br><span class="line">DROP VIEW [IF EXISTS] 视图名称1 [,视图名称2 ...]</span><br></pre></td></tr></table></figure>
<h3 id="创建数据表"><a href="#创建数据表" class="headerlink" title="创建数据表"></a>创建数据表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE [IF NOT EXISTS] 表名称 (</span><br><span class="line">	列名称1 数据类型1，</span><br><span class="line">	列名称2 数据类型2，</span><br><span class="line">	...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="查看数据表"><a href="#查看数据表" class="headerlink" title="查看数据表"></a>查看数据表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW TABLES [FROM 数据库] [LIKE 模式 | WHERE 表达式]</span><br></pre></td></tr></table></figure>
<p>可以查看当前或其他数据库中的所有数据表列表，查看其他数据库并不会修改当前的数据库。</p>
<h3 id="查看数据表结构"><a href="#查看数据表结构" class="headerlink" title="查看数据表结构"></a>查看数据表结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW COLUMNS FROM 表名称</span><br></pre></td></tr></table></figure>
<h3 id="记录的查找"><a href="#记录的查找" class="headerlink" title="记录的查找"></a>记录的查找</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 表达式,... FROM 表名称</span><br></pre></td></tr></table></figure>
<h3 id="记录的插入"><a href="#记录的插入" class="headerlink" title="记录的插入"></a>记录的插入</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT [INTO] 表名称[(列名称1, 列名称2,...) ] VALUE[S] (值1, 值2,....)</span><br></pre></td></tr></table></figure>
<p>注：</p>
<ul>
<li>可以写做 VALUES，也可以写做 VALUE。当数据量较少时，使用 VALUES 效率较高，反之相反。</li>
<li>如果省略列名称，则需要为所有列赋值</li>
</ul>
<h3 id="清空记录"><a href="#清空记录" class="headerlink" title="清空记录"></a>清空记录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TRUNCATE TABLE 表名称</span><br></pre></td></tr></table></figure>
<p>注：TRUNCATE TABLE 清空表内的数据，但并不删除表本身。</p>
<h3 id="空值与非空"><a href="#空值与非空" class="headerlink" title="空值与非空"></a>空值与非空</h3><ul>
<li>NULL，字段值可以为空</li>
<li>NOT NULL，字段值不可以为空</li>
<li>NULL 用作未知的或不适用的值的占位符。<br>如果表中的某个列是可选的且未赋值，则该字段将以 NULL 值保存。</li>
</ul>
<p>无法使用比较运算符来测试 NULL 值，比如 =, &lt;, 或者 &lt;&gt;。必须使用 IS NULL 和 IS NOT NULL 操作符。</p>
<p>注：NULL 和 0 是不等价的。</p>
<h3 id="自动编号"><a href="#自动编号" class="headerlink" title="自动编号"></a>自动编号</h3><p>AUTO INCREMENT 自动地创建（主）键字段的值。  </p>
<ul>
<li>AUTO INCREMENT 的字段必须为索引（KEY）</li>
<li>AUTO INCREMENT 的字段必须为 INT 类型</li>
<li>一个表只能有一个 AUTO INCREMENT 字段</li>
<li>默认地，AUTO_INCREMENT 的开始值是 1，每条新记录递增 1。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名称</span><br><span class="line">(</span><br><span class="line">  列名称 数据类型 AUTO_INCREMENT,</span><br><span class="line">  ...</span><br><span class="line">  [PRIMARY] KEY (列名称)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>要让 AUTO_INCREMENT 序列以其他的值起始，使用下列 SQL 语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 AUTO_INCREMENT=起始值</span><br></pre></td></tr></table></figure>
<h3 id="WHERE-子句"><a href="#WHERE-子句" class="headerlink" title="WHERE 子句"></a>WHERE 子句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT 列名称 FROM 表名称 WHERE 表达式 </span><br><span class="line">其中，表达式 = 列 运算符 值</span><br></pre></td></tr></table></figure>
<p>运算符：</p>
<table>
<thead>
<tr>
<th style="text-align:center">操作符</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">=</td>
<td style="text-align:center">等于</td>
</tr>
<tr>
<td style="text-align:center">&lt;&gt;    或!=</td>
<td style="text-align:center">不等于</td>
</tr>
<tr>
<td style="text-align:center">&gt;</td>
<td style="text-align:center">大于</td>
</tr>
<tr>
<td style="text-align:center">&lt;</td>
<td style="text-align:center">小于</td>
</tr>
<tr>
<td style="text-align:center">&gt;=</td>
<td style="text-align:center">大于等于</td>
</tr>
<tr>
<td style="text-align:center">&lt;=</td>
<td style="text-align:center">小于等于</td>
</tr>
<tr>
<td style="text-align:center">BETWEEN…AND</td>
<td style="text-align:center">[不]在某个范围内</td>
</tr>
<tr>
<td style="text-align:center">[NOT] LIKE</td>
<td style="text-align:center">[不]匹配某种模式</td>
</tr>
<tr>
<td style="text-align:center">[NOT] IN()</td>
<td style="text-align:center">[不]在列出的值中</td>
</tr>
<tr>
<td style="text-align:center">IS [NOT] NULL</td>
<td style="text-align:center">值[不]为 NULL</td>
</tr>
</tbody>
</table>
<p>注：NULL 的列作为查询条件时，无论使用 &gt;、&lt;、&gt;=、&lt;= 都是不符合条件的，只能使用 IS NULL 来判断。  </p>
<h4 id="BETWEEN"><a href="#BETWEEN" class="headerlink" title="BETWEEN"></a>BETWEEN</h4><p>WHERE 操作符用于选取介于两个值之间的数据范围，可以是数值、文本或者日期。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 列名称 FROM 表名称 WHERE 列名称 BETWEEN 值1 AND 值2</span><br></pre></td></tr></table></figure>
<p>注：MySql 数据库会列出介于值 1 和值 2 之间并包括值 1 和值 2 的纪录</p>
<h4 id="LIKE"><a href="#LIKE" class="headerlink" title="LIKE"></a>LIKE</h4><p>LIKE 操作符用于在 WHERE 子句中搜索列中的指定模式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 列名称 FROM 表名称 WHERE 列名称 [NOT] LIKE 模式</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">通配符</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">%</td>
<td style="text-align:center">替代零个或多个字符</td>
</tr>
<tr>
<td style="text-align:center">_</td>
<td style="text-align:center">仅替代一个字符</td>
</tr>
<tr>
<td style="text-align:center">[charlist]</td>
<td style="text-align:center">字符列中的任何单一字符</td>
</tr>
<tr>
<td style="text-align:center">[^charlist]或[!charlist]</td>
<td style="text-align:center">不在字符列中的任何单一字符</td>
</tr>
</tbody>
</table>
<p>注：如果想匹配 %，需要写成 <code>%1%% ESCAPE &#39;1&#39;</code>，表示1以后的字符不需要进行通配符匹配。</p>
<h4 id="IN"><a href="#IN" class="headerlink" title="IN()"></a>IN()</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 列名称 FROM 表名称 WHERE 列名称 IN (值1, 值2, ...)</span><br></pre></td></tr></table></figure>
<p>注：IN() 和 OR 在逻辑上是完全相等的，多数据库服务器都把它们看作同义词。</p>
<p>但 MYSQL 不是这样的，它会对 IN() 里面的数据进行排序，然后用二分法查找个是否在列表中，这个算法的效率是 O(logN)，而等同的 OR 子句的查找效率是 O(n)。因此在列表很大的时候，OR 子句会比 IN() 慢得多，应优先使用 IN()。 </p>
<p>可参考：<a href="http://m.blog.chinaunix.net/uid-20639775-id-3416737.html" target="_blank" rel="noopener">http://m.blog.chinaunix.net/uid-20639775-id-3416737.html</a></p>
<h4 id="AND-amp-OR"><a href="#AND-amp-OR" class="headerlink" title="AND &amp; OR"></a>AND &amp; OR</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 列名称 FROM 表名称 WHERE 表达式 连接运算符 表达式</span><br></pre></td></tr></table></figure>
<p>运算符：</p>
<table>
<thead>
<tr>
<th style="text-align:center">操作符</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">AND</td>
<td style="text-align:center">连接条件：同时成立</td>
</tr>
<tr>
<td style="text-align:center">OR</td>
<td style="text-align:center">连接条件：有一个成立</td>
</tr>
</tbody>
</table>
<h4 id="GROUP-BY"><a href="#GROUP-BY" class="headerlink" title="GROUP BY"></a>GROUP BY</h4><p>GROUP BY 语句根据一个或多个列对结果集进行分组。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[GROUP BY &#123;列名称|位置&#125; [ASC|DESC], ...]</span><br></pre></td></tr></table></figure>
<p>多个分组条件以逗号分隔。<br>位置是指字段的顺序位置，建议使用列名称。</p>
<h4 id="HAVING"><a href="#HAVING" class="headerlink" title="HAVING"></a>HAVING</h4><p>HAVING 与 GROUP BY 搭配使用，指明了分组的条件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[HAVING where &#123;列名称|位置&#125; [ASC|DESC], ...]</span><br></pre></td></tr></table></figure>
<p>注：使用 HAVING 进行分组时，要么为聚合函数，要么字段必须出现在 SELECT 语句中。即必须保证返回结果为一个数，而非一列。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 会报错</span><br><span class="line">SELECT sex FROM users GROUP BY 1 HAVING age &gt; 35</span><br><span class="line"></span><br><span class="line">// 使用聚合函数</span><br><span class="line">SELECT sex FROM users GROUP BY 1 HAVING count(id) &gt; 35</span><br></pre></td></tr></table></figure>
<h4 id="ORDER-BY"><a href="#ORDER-BY" class="headerlink" title="ORDER BY"></a>ORDER BY</h4><p>对查询结果进行排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ORDER BY &#123;列名称｜表达式｜位置&#125;] [ASC｜DESC], ...]</span><br></pre></td></tr></table></figure>
<p>注：  </p>
<ol>
<li>只有 ORDER BY 的列是按顺序排列的，剩下列是按插入顺序排列的  </li>
<li>数值为 NULL 的记录，被认为是最小的。因此升序排列时 NULL 值默认排在最前，反之相反</li>
</ol>
<h4 id="LIMIT"><a href="#LIMIT" class="headerlink" title="LIMIT"></a>LIMIT</h4><p>限制查询结果返回的数量，等价于其他数据库中的 SELECT TOP。</p>
<p>LIMIT 共有两种语法结构，两种方式是等价的。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[LIMIT &#123;[偏移量,] 记录个数|记录个数 OFFSET 偏移量&#125;]</span><br></pre></td></tr></table></figure>
<p>注：第一条记录的偏移量是 0。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM TABLE LIMIT 5; // 返回前 5 行</span><br><span class="line">SELECT * FROM TABLE LIMIT 5,10; // 返回 6-15 行</span><br></pre></td></tr></table></figure>
<h4 id="AS"><a href="#AS" class="headerlink" title="AS"></a>AS</h4><p>AS 为列名称和表名称指定别名（Alias）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 表名的别名</span><br><span class="line">SELECT 列名称 FROM 表名称 AS 别名</span><br><span class="line"></span><br><span class="line">// 列名的别名</span><br><span class="line">SELECT 列名称 AS 别名 FROM 表名称</span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 表名的别名</span><br><span class="line">SELECT po.OrderID, p.LastName, p.FirstName</span><br><span class="line">FROM Persons AS p, Product_Orders AS po</span><br><span class="line">WHERE p.LastName=&apos;Adams&apos; AND p.FirstName=&apos;John&apos;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 列名的别名</span><br><span class="line">SELECT LastName AS Family, FirstName AS Name</span><br><span class="line">FROM Persons</span><br></pre></td></tr></table></figure>
<p><img src="sql-1.png"></p>
<p>注：  </p>
<ol>
<li>如果对表设置了别名，那么只能用别名访问表，用原始名称是无法访问的  </li>
<li>如果对列设置了别名，那么返回的结果中，列名被修改为别名</li>
</ol>
<h2 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h2><p>约束用于限制加入表的数据的类型。</p>
<p>可以在创建表时规定约束（通过 CREATE TABLE 语句），或者在表创建之后也可以（通过 ALTER TABLE 语句）。</p>
<p><strong>列级约束：</strong><br>对一个数据建立的约束<br>列级约束既可以在列定义时声明，也可以在列定义后声明</p>
<ul>
<li>PRIMARY KEY（主键）</li>
<li>FOREIGN KEY（外键）</li>
<li>UNIQUE（唯一值）</li>
<li>CHECK</li>
</ul>
<p><strong>表级约束：</strong><br>对多个数据建立的约束<br>列级约束只能在列定义后声明</p>
<ul>
<li>NOT NULL（非空约束）</li>
<li>DEFAULT（默认值）</li>
</ul>
<h3 id="NOT-NULL"><a href="#NOT-NULL" class="headerlink" title="NOT NULL"></a>NOT NULL</h3><p>NOT NULL 约束强制列不接受 NULL 值。</p>
<p>NOT NULL 约束强制字段始终包含值。这意味着，如果不向字段添加值，就无法插入新记录或者更新记录。否则，会报错 <code>Field xxx doesn&#39;t have a default value</code></p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE Persons</span><br><span class="line">(</span><br><span class="line">  列名称1 数据类型 NOT NULL,</span><br><span class="line">  ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="UNIQUE"><a href="#UNIQUE" class="headerlink" title="UNIQUE"></a>UNIQUE</h3><p>UNIQUE 约束唯一标识数据库表中的每条记录，即设置了 UNIQUE 约束的列只能有唯一的值，无法添加重复的值。</p>
<p>UNIQUE 和 PRIMARY KEY 约束均为列或列集合提供了唯一性的保证。</p>
<p>PRIMARY KEY 拥有自动定义的 UNIQUE 约束。</p>
<p>注：每个表可以有多个 UNIQUE 约束，但是每个表只能有一个 PRIMARY KEY 约束。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名称</span><br><span class="line">(</span><br><span class="line">  列名称 数据类型,</span><br><span class="line">  ...</span><br><span class="line">  UNIQUE (列名称1, 列名称2, ...)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>创建表时，为 UNIQUE 约束命名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名称</span><br><span class="line">(</span><br><span class="line">  列名称 数据类型,</span><br><span class="line">  ...</span><br><span class="line">  CONSTRAINT 约束名称 UNIQUE (列名称1, 列名称2, ...)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="PRIMARY-KEY"><a href="#PRIMARY-KEY" class="headerlink" title="PRIMARY KEY"></a>PRIMARY KEY</h3><p>PRIMARY KEY（主键）约束唯一标识数据库表中的每条记录。注：主键创建的同时会自动创建索引</p>
<p>主键必须包含唯一的值。</p>
<p>主键列不能包含 NULL 值。</p>
<p>每个表都应该有一个主键，并且每个表只能有一个主键。</p>
<p>创建表时，为 PRIMARY KEY 约束命名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名称</span><br><span class="line">(</span><br><span class="line">  列名称 数据类型,</span><br><span class="line">  ...</span><br><span class="line">  [CONSTRAINT 约束名称] PRIMARY KEY (列名称1, 列名称2, ...)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="FOREIGN-KEY"><a href="#FOREIGN-KEY" class="headerlink" title="FOREIGN KEY"></a>FOREIGN KEY</h3><p>FOREIGN KEY(外键) 约束了它的值必须为指向的那个表中的值之一，用于预防破坏表之间连接的动作。</p>
<p>表中的 FOREIGN KEY 必须指向另一个表中的 PRIMARY KEY。</p>
<p>外键约束：</p>
<ul>
<li>父表（参照列所在表）和子表（外键列所在表）必须使用相同的存储引擎，禁止使用临时表</li>
<li>数据表的存储引擎只能为 InnoDB</li>
<li>外键列和参照列必须具有相似的数据类型。其中数字的长度或是否有富豪为必需相同，而字符的长度则可以不同</li>
<li>外键列和参照列必须创建索引，如果参照列不存在索引的话，MySQL 将自动创建索引，但外键列不存在索引的话，MySQL 不会创建索引。</li>
</ul>
<p>外键约束的参照操作：</p>
<ul>
<li>CASCADE：从父表删除或更新且自动删除更新字表中匹配的行</li>
<li>SET NULL：从父表删除或更新行，并设置字表中的外键列为 NULL。如果使用该选项，必须保证字表列没有指定 NOT NULL</li>
<li>RESTRICT：拒绝对父表的删除或更新操作</li>
<li>NO ACTION：标准 SQL 的关键字，在 MySQL 中与 RESTRICT 相同</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表2名称</span><br><span class="line">(</span><br><span class="line">  列名称 数据类型,</span><br><span class="line">  ...</span><br><span class="line">  [CONSTRAINT 约束名称] </span><br><span class="line">  FOREIGN KEY (外键列名称1, 外键列名称2, ...) </span><br><span class="line">  REFERENCES 表1名称(主键列名称)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="CHECK"><a href="#CHECK" class="headerlink" title="CHECK"></a>CHECK</h3><p>CHECK 约束用于限制列中的值的范围。</p>
<p>如果对单个列定义 CHECK 约束，那么该列只允许特定的值。</p>
<p>如果对一个表定义 CHECK 约束，那么此约束会在特定的列中对值进行限制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名称</span><br><span class="line">(</span><br><span class="line">  列名称 数据类型,</span><br><span class="line">  ...</span><br><span class="line">  [CONSTRAINT 约束名称] CHECK (表达式)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>注：<br>所有的存储引擎均对 CHECK 子句进行分析，但是忽略 CHECK 子句。因此，CHECK 语句并不起作用。<br>解决方法就是用 Trigger 触发器, 在触发器中利用一个出错的语句来中断代码的执行.</p>
<h3 id="DEFAULT"><a href="#DEFAULT" class="headerlink" title="DEFAULT"></a>DEFAULT</h3><p>DEFAULT 约束用于向列中插入默认值。<br>如果没有规定其他的值，那么会将默认值添加到所有的新记录。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名称</span><br><span class="line">(</span><br><span class="line">  列名称 数据类型 DEFAULT 默认值／函数,</span><br><span class="line">  ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="修改数据表"><a href="#修改数据表" class="headerlink" title="修改数据表"></a>修改数据表</h2><h3 id="添加-删除列"><a href="#添加-删除列" class="headerlink" title="添加/删除列"></a>添加/删除列</h3><p>ALTER TABLE 语句用于在已有的表中添加、修改或删除列。</p>
<p>添加单列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 ADD [COLUMN] 列名称 数据类型 [FIRST|AFTER 列名称]</span><br></pre></td></tr></table></figure>
<p>添加多列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 ADD [COLUMN] (列名称1 数据类型1, 列名称2 数据类型2, ...)</span><br></pre></td></tr></table></figure>
<p>注：添加多列时无法指定插入的位置，只能插入表的最后</p>
<p>删除单列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 DROP [COLUMN] 列名称</span><br></pre></td></tr></table></figure>
<p>删除多列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 DROP [COLUMN] 列名称1, DROP [COLUMN] 列名称2, ...</span><br></pre></td></tr></table></figure>
<h3 id="添加-删除约束"><a href="#添加-删除约束" class="headerlink" title="添加/删除约束"></a>添加/删除约束</h3><p>添加 PRIMARY KEY:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 ADD [CONSTRAINT 约束名称] PRIMARY KEY [索引类型] (列名称1, 列名称2, ...)</span><br></pre></td></tr></table></figure>
<p>注：索引类型包括 hash 索引和 B-tree 索引</p>
<p>添加 UNIQUE:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 ADD [CONSTRAINT 约束名称] UNIQUE [INDEX|KEY] [索引名称] [索引类型] (列名称1, 列名称2, ...)</span><br></pre></td></tr></table></figure>
<p>注：如果添加 UNIQUE 之前，索引已经具有重复的值，则无法为其添加 UNIQUE 约束</p>
<p>添加 FOREIGN KEY:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 ADD [CONSTRAINT 约束名称] FOREIGN KEY [索引名称] (外键列名称1, 外键列名称2, ...) REFERENCES 表2名称(主键列名称)</span><br></pre></td></tr></table></figure>
<p>外键约束与参照要求与创建时相同。</p>
<p>添加 DEFAULT:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 ALTER [COLUMN] 列名称 SET DEFAULT 默认值</span><br></pre></td></tr></table></figure>
<p>添加 CHECK:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 ADD [CONSTRAINT 约束名称] CHECK (表达式)</span><br></pre></td></tr></table></figure></p>
<p>删除 PRIMARY KEY： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 DROP PRIMARY KEY</span><br></pre></td></tr></table></figure>
<p>删除 UNIQUE： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 DROP &#123;INDEX|KEY&#125; 索引名称</span><br></pre></td></tr></table></figure>
<p>删除 FOREIGN KEY： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 DROP FOREIGN KEY 外键约束名称</span><br></pre></td></tr></table></figure>
<p>注：我们可以通过 <code>SHOW CREATE TABLE 表名称</code>来查看 FOREIGN KEY</p>
<p>删除 DEFAULT： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 ALTER [COLUMN] 列名称 DROP DEFAULT</span><br></pre></td></tr></table></figure>
<p>删除 CHECK： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 DROP CHECK 约束名称</span><br></pre></td></tr></table></figure>
<h3 id="修改列定义"><a href="#修改列定义" class="headerlink" title="修改列定义"></a>修改列定义</h3><p>列定义包括数据类型、位置等</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 MODIFY [COLUMN] 列名称 数据类型 [FIRST|AFTER 列名称]</span><br></pre></td></tr></table></figure>
<p>修改列名称：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 CHANGE [COLUMN] 原列名称 新列名称 数据类型 [FIRST|AFTER 列名称]</span><br></pre></td></tr></table></figure>
<p>注：</p>
<ul>
<li>修改数据类型后可能导致数据丢失。</li>
<li>CHANGE 比 MODIFIY 功能更强大</li>
</ul>
<h3 id="修改数据表-1"><a href="#修改数据表-1" class="headerlink" title="修改数据表"></a>修改数据表</h3><p>修改表名称</p>
<p>方法一：修改单个表名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 RENAME [TO|AS] 新表名称</span><br></pre></td></tr></table></figure>
<p>方法二：修改单个或多个表名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE 表名称 TO 新表名称 [, 表2名称，新表2名称, ...]</span><br></pre></td></tr></table></figure>
<h2 id="记录操作-－-单表操作"><a href="#记录操作-－-单表操作" class="headerlink" title="记录操作 － 单表操作"></a>记录操作 － 单表操作</h2><h3 id="INSERT-插入记录"><a href="#INSERT-插入记录" class="headerlink" title="INSERT 插入记录"></a>INSERT 插入记录</h3><p><strong>方法一: INSERT…VALUES </strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT [INTO] 表名称 [(列名称1, 列名称2, ...)] </span><br><span class="line">&#123;VALUES|VALUE&#125; (&#123;数值|函数|数学表达式|DEFAULT&#125;, ...), (...)</span><br></pre></td></tr></table></figure>
<ul>
<li>如果省略 <code>(列名称1, 列名称2, ...)</code>，则表示每个字段都需要被赋值。</li>
<li>如果让 AUTO_INCREMENT 的字段使用默认值，可以传入 NULL 或 DEFAULT</li>
</ul>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 赋值数学表达式</span><br><span class="line">INSERT table VALUES (&apos;1&apos;, 3*7-1, ...)</span><br><span class="line"></span><br><span class="line">// 赋值默认值</span><br><span class="line">INSERT table VALUES (DEFAULT, 3*7-1, ...)</span><br><span class="line"></span><br><span class="line">// 赋值多条记录</span><br><span class="line">INSERT table VALUES (DEFAULT, 3*7-1, ...),(&apos;1&apos;, md5(123), ...)</span><br></pre></td></tr></table></figure>
<p><strong>方法二: INSERT…SET</strong></p>
<p>与第一种方式的区别在于此方法可以使用子查询（SubQuery），比较运算符的子查询，此外，该方法只能插入一条记录，无法插入多条记录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT [INTO] 表名称 </span><br><span class="line">SET 列名称 = &#123;表达式 | DEFAULT&#125;, ...</span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT table SET username=&apos;Ben&apos;, password=&apos;456&apos;;</span><br></pre></td></tr></table></figure>
<p>注：可以引发子查询是因为使用了比较运算符，参见“子查询”部分内容。</p>
<p><strong>方法三: INSERT…SELECT</strong></p>
<p>此为多表操作！！！！<br>参见下面多表部分</p>
<h3 id="UPDATE-修改记录"><a href="#UPDATE-修改记录" class="headerlink" title="UPDATE 修改记录"></a>UPDATE 修改记录</h3><p><strong>单表更新</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE [LOW_PRIORITY] [IGNORE] 表索引 </span><br><span class="line">SET 列1名称=&#123;表达式1｜DEFAULT&#125; [, 列2名称=&#123;表达式2｜DEFAULT&#125;, ... ] </span><br><span class="line">[WHERE 条件语句]</span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 字段 age 每个记录加 5</span><br><span class="line">UPDATE table SET age = age + 5</span><br><span class="line"></span><br><span class="line">// 字段 age 每个记录 - id 的值，sex 设为 0</span><br><span class="line">UPDATE table SET age = age - id, sex = 0</span><br><span class="line"></span><br><span class="line">// id 字段为偶数的 age 字段每个记录+10</span><br><span class="line">UPDATE table SET age = age + 10 WHERE id % 2 = 0</span><br></pre></td></tr></table></figure>
<h3 id="DELETE-删除记录"><a href="#DELETE-删除记录" class="headerlink" title="DELETE 删除记录"></a>DELETE 删除记录</h3><p><strong>单表删除</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM 表名称 [WHERE 条件语句]</span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 删除第 6 条记录</span><br><span class="line">DELETE FROM users WHERE id = 6</span><br></pre></td></tr></table></figure>
<p><strong>多表删除</strong></p>
<h3 id="SELECT-查询记录"><a href="#SELECT-查询记录" class="headerlink" title="SELECT 查询记录"></a>SELECT 查询记录</h3><p>查询表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT 查询表达式 [, 查询表达式] </span><br><span class="line">[</span><br><span class="line">  FROM 表索引</span><br><span class="line">  [WHERE 条件语句]</span><br><span class="line">  [GROUP BY &#123;列名称|位置&#125; [ASC|DESC], ...]</span><br><span class="line">  [HAVING 条件语句]</span><br><span class="line">  [ORDER BY &#123;列名称｜表达式｜位置&#125; [ASC|DESC], ...]</span><br><span class="line">  [LIMIT &#123;[偏移位置,] 行数| 行数 OFFSET 位置&#125;]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>查询表达式：</p>
<ul>
<li>每一个表达式表示想要的一列，必须至少有一个</li>
<li>多个列之间以英文逗号分割</li>
<li>对于多张表，可以使用 <code>表名称.列名称</code> 表示不同表的列</li>
<li>别名（AS）可用于 GROUP BY, ORDER BY 或 HAVING 子句，AS 可以省略，但是强烈建议不要省略</li>
</ul>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 查找函数</span><br><span class="line">SELECT NOW()</span><br><span class="line"></span><br><span class="line">// 查找表达式</span><br><span class="line">SELECT 3+5</span><br><span class="line"></span><br><span class="line">// 省略 AS，username 是 id 的别名，易混淆，不要省略 AS</span><br><span class="line">SELECT id username FROM users</span><br></pre></td></tr></table></figure>
<h2 id="记录操作-－-多表操作"><a href="#记录操作-－-多表操作" class="headerlink" title="记录操作 － 多表操作"></a>记录操作 － 多表操作</h2><h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><p>子查询（SubQuery）是指出现在其他 SQL 语句内的 SELECT 子句。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM t1 WHERE col1 = (SELECT col2 FROM t2)</span><br></pre></td></tr></table></figure>
<p>其中，<code>SELECT * FROM t1</code> 称为 Outer Query，<code>SELECT col2 FROM t2</code> 称为 SubQuery。</p>
<ul>
<li>子查询是指嵌套在查询内部，必须始终出现在圆括号内。</li>
<li>子查询可以包含多个关键字或条件，如 DISTINCT, GROUP BY, ORDER BY, LIMIT, 函数等。</li>
<li>子查询的外层查询可以是 SELECT, INSERT, UPDATE, SET 或 DO。</li>
<li>子查询可以返回标量、一行、一列或子查询。</li>
</ul>
<h4 id="使用比较运算符的子查询"><a href="#使用比较运算符的子查询" class="headerlink" title="使用比较运算符的子查询"></a>使用比较运算符的子查询</h4><p>比较运算符包括 =、&gt;、&lt;、&gt;=、&lt;=、&lt;&gt;、!=、&lt;=&gt;。</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT goods_id, goods_name, goods_price FROM tdb_goods WHERE goods_price &gt; (SELECT ROUND(AVG(goods_price)) FROM tdb_goods)</span><br></pre></td></tr></table></figure>
<p>如果子查询的返回结果为多行，可以使用 ANY、SOME 或 ALL 关键字进行修饰。ANY 与 SOME 等价，表示符合其中之一即可。</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">ANY</th>
<th style="text-align:left">SOME</th>
<th style="text-align:left">ALL</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">&gt;、&gt;=</td>
<td style="text-align:left">最小值</td>
<td style="text-align:left">最小值</td>
<td style="text-align:left">最大值</td>
</tr>
<tr>
<td style="text-align:left">&lt;、&lt;=</td>
<td style="text-align:left">最大值</td>
<td style="text-align:left">最大值</td>
<td style="text-align:left">最小值</td>
</tr>
<tr>
<td style="text-align:left">=</td>
<td style="text-align:left">任意值</td>
<td style="text-align:left">任意值</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">&lt;&gt;、!=</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">任意值</td>
</tr>
</tbody>
</table>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT goods_id, goods_name, goods_price FROM tdb_goods</span><br><span class="line">WHERE goods_price &gt; SOME(SELECT goods_price FROM tdb_goods)</span><br></pre></td></tr></table></figure>
<h4 id="使用-NOT-IN-的子查询"><a href="#使用-NOT-IN-的子查询" class="headerlink" title="使用 [NOT] IN 的子查询"></a>使用 [NOT] IN 的子查询</h4><p>=ANY 运算符与 IN 等价<br>!=ALL 或 &lt;&gt;ALL 与 NOT IN 等价</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 下面两种写法等价</span><br><span class="line">SELECT goods_id, goods_name, goods_price FROM tdb_goods</span><br><span class="line">WHERE goods_price != ALL(SELECT goods_price FROM tdb_goods)</span><br><span class="line"></span><br><span class="line">SELECT goods_id, goods_name, goods_price FROM tdb_goods</span><br><span class="line">WHERE goods_price NOT IN (SELECT goods_price FROM tdb_goods)</span><br></pre></td></tr></table></figure>
<h4 id="使用-NOT-EXIST-的子查询"><a href="#使用-NOT-EXIST-的子查询" class="headerlink" title="使用 [NOT] EXIST 的子查询"></a>使用 [NOT] EXIST 的子查询</h4><p>如果子查询返回任何行，EXISTS 将返回 TRUE；否则返回 FALSE</p>
<h3 id="INSERT-插入记录-1"><a href="#INSERT-插入记录-1" class="headerlink" title="INSERT 插入记录"></a>INSERT 插入记录</h3><p><strong>INSERT…SELECT</strong></p>
<p>INSERT…SELECT 可以将一个表中的查询结果写入另一个表中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT [INTO] 表名称 [(列1名称, 列2名称, ...)] </span><br><span class="line">SELECT ...</span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 将一个(users)表中的记录写入另一个(test)表</span><br><span class="line">INSERT test(username) SELECT username FROM users WHERE age &gt;=30</span><br></pre></td></tr></table></figure>
<p>注：由于 test 是一个字段，因此必须保证 SELECT 得到的结果集也是一个字段。</p>
<h3 id="UPDATE-更新记录"><a href="#UPDATE-更新记录" class="headerlink" title="UPDATE 更新记录"></a>UPDATE 更新记录</h3><p>多表的更新是指，参照一个表更新另一个表的内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE 参照表关系</span><br><span class="line">SET 列1名称 = &#123;表达式｜DEFAULT&#125;</span><br><span class="line">[, 列2名称 = &#123;表达式｜DEFAULT&#125; ...]</span><br><span class="line">[WHERE 条件语句]</span><br></pre></td></tr></table></figure>
<p>其中，参照表关系的语法结构为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">表1 </span><br><span class="line">&#123;[INNER|CROSS] JOIN | &#123;LEFT|RIGHT&#125; [OUTER] JOIN&#125;</span><br><span class="line">表2</span><br><span class="line">ON 连接条件表达式</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 将 tdb_goods 表的 goods_cate 字段更新为 tdb_goods_cates 表的 cate_id 字段值，其中两个表之间 goods_cate 与 goods_name 具有参照关系</span><br><span class="line">UPDATE tdb_goods INNER JOIN tdb_goods_cates ON goods_cate = goods_name </span><br><span class="line">SET goods_cate = cate_id</span><br></pre></td></tr></table></figure>
<h3 id="CREATE…SELECT-创建并更新记录"><a href="#CREATE…SELECT-创建并更新记录" class="headerlink" title="CREATE…SELECT 创建并更新记录"></a>CREATE…SELECT 创建并更新记录</h3><p>用上面的两个方法，我们可以实现多表的创建后更新：</p>
<ul>
<li>第一步：创建表</li>
<li>第二步：通过 INSERT SELECT 将记录写入新创建的表</li>
<li>第三步：多表更新</li>
</ul>
<p>此外，我们可以使用 CREATE…SELECT 以更精简的方式，在创建数据表同时将查询结果写入到数据表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE [IF NOT EXISTS] 表名称</span><br><span class="line">[(创建表定义, ...)]</span><br><span class="line">选择语句</span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 创建 tdb_goods_brands，并根据该表更新 tdb_goods 表</span><br><span class="line">CREATE TABLE tdb_goods_brands (</span><br><span class="line">	brand_id SMALLINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	brand_name VARCHAR(40) NOT NULL</span><br><span class="line">) SELECT brand_name FROM tdb_goods GROUP BY brand_name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UPDATE tdb_goods INNER JOIN tdb_goods_brands ON brand_name = brand_name</span><br><span class="line">SET brand_name = brand_id</span><br></pre></td></tr></table></figure>
<h3 id="连接数据"><a href="#连接数据" class="headerlink" title="连接数据"></a>连接数据</h3><p>连接数据是多表操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">表1的指向</span><br><span class="line">&#123;[INNER | CROSS] JOIN | &#123;LEFT|RIGHT&#125; [OUTER] JOIN&#125;</span><br><span class="line">表2的指向</span><br><span class="line">ON 连接条件</span><br></pre></td></tr></table></figure>
<p>ON 关键字来设定连接条件，<br>WHERE 进行结果集记录的过滤。</p>
<p>其中，表的指向：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">表名称 [[AS] 别名] | 表子查询 [AS] 别名</span><br></pre></td></tr></table></figure>
<p>数据表可以使用 <code>表名称 AS 别名</code> 或 <code>表名称 别名</code> 赋予别名，<code>表子查询</code> 使用在 FROM 子句中必须为其赋予别名。</p>
<p>当连接时存在多表有同名字段时，必须为其赋予别名，或指定某个表下的某个字段。</p>
<h4 id="INNER-JOIN-…-ON"><a href="#INNER-JOIN-…-ON" class="headerlink" title="INNER JOIN … ON"></a>INNER JOIN … ON</h4><p>在 MySQL 中， JOIN、CROSS JOIN 和 INNER JOIN 是等价的，均为内连接。例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT PERSONS.LASTNAME, PERSONS.FIRSTNAME, ORDERJOIN.ORDERNO FROM PERSONS INNER JOIN ORDERJOIN ON PERSONS.ID_P = ORDERJOIN.ID_P</span><br></pre></td></tr></table></figure>
<p>INNER JOIN … ON 也可以用 WHERE 来代替，例如下面的语句与上面的语句是等价的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT persons.lastname, persons.firstname, orderjoin.orderno FROM persons, orderjoin WHERE persons.id_p = orderjoin.id_p</span><br></pre></td></tr></table></figure>
<p>多表（大于两张表）的连接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT goods_id, goods_name, cate_name, brand_name, goods_price AS g</span><br><span class="line">INNER JOIN tdb_good_cates AS c ON g.cate_id = c.cate_id</span><br><span class="line">INNER JOIN tdb_goods_brands AS b ON g.brands_id = b.brands_id</span><br></pre></td></tr></table></figure>
<h4 id="LEFT-JOIN-…-ON-／-RIGHT-JOIN-…-ON"><a href="#LEFT-JOIN-…-ON-／-RIGHT-JOIN-…-ON" class="headerlink" title="LEFT JOIN … ON ／ RIGHT JOIN … ON"></a>LEFT JOIN … ON ／ RIGHT JOIN … ON</h4><p>LEFT JOIN 关键字会从左表返回所有的行，即使在右表中没有匹配的行。<br>RIGHT JOIN 关键字会从右表返回所有的行，即使在左表中没有匹配的行。</p>
<p>假设左表是 A，右表是 B。</p>
<p>如果 B 表符合条件的记录数大于 1 条，就会出现 1:n 的情况，这样 LEFT JOIN 后的结果，记录数会多于 A 表的记录数。</p>
<h4 id="FULL-JOIN【MYSQL-不支持】"><a href="#FULL-JOIN【MYSQL-不支持】" class="headerlink" title="FULL JOIN【MYSQL 不支持】"></a>FULL JOIN【MYSQL 不支持】</h4><p>FULL JOIN 会从左表和右表返回所有行。如果左表中的行在右表中没有匹配，或者右表中的行在左表中没有匹配，这些行同样会列出。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT 表1列名称, 表2列名称 FROM 表1名称 FULL JOIN 表2名称 </span><br><span class="line">ON 表1名称.表1列名称 ＝ 表2名称.表2列名称</span><br></pre></td></tr></table></figure>
<h4 id="CROSS-JOIN"><a href="#CROSS-JOIN" class="headerlink" title="CROSS JOIN"></a>CROSS JOIN</h4><p>CROSS JOIN 会从左表和右表进行一个 N*M 的组合，即笛卡尔积。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT 表1列名称, 表2列名称 FROM 表1名称 CROSS JOIN 表2名称</span><br></pre></td></tr></table></figure>
<h4 id="UNION-／-UNION-ALL"><a href="#UNION-／-UNION-ALL" class="headerlink" title="UNION ／ UNION ALL"></a>UNION ／ UNION ALL</h4><p>UNION 操作符用于合并两个或多个 SELECT 语句的结果集，即合并索引的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT 列名称 FROM 表1</span><br><span class="line">UNION</span><br><span class="line">SELECT 列名称 FROM 表2</span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT E_ID, E_NAME FROM EMPLOYEES_USA </span><br><span class="line">UNION </span><br><span class="line">SELECT E_ID, E_NAME FROM EMPLOYEES_CHINA</span><br></pre></td></tr></table></figure>
<p>注：  </p>
<ol>
<li>UNION 内部的 SELECT 语句必须拥有相同数量的列。列也必须拥有相似的数据类型。同时，每条 SELECT 语句中的列的顺序必须相同。</li>
</ol>
<p>例如下面的情况会报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT E_NAME, E_ID FROM EMPLOYEES_USA </span><br><span class="line">UNION </span><br><span class="line">SELECT E_NAME FROM EMPLOYEES_CHINA</span><br></pre></td></tr></table></figure>
<ol>
<li>如果表1和表2的某个索引下有相同的值，则只保留表1的，即 UNION 命令只会选取唯一的值。如果希望保留所有值，则必须使用 <code>UNION ALL</code> 命令：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT 列名称 FROM 表1</span><br><span class="line">UNION ALL</span><br><span class="line">SELECT 列名称 FROM 表2</span><br></pre></td></tr></table></figure>
<h3 id="关于连接的几点说明"><a href="#关于连接的几点说明" class="headerlink" title="关于连接的几点说明"></a>关于连接的几点说明</h3><p>A LEFT JOIN B 连接条件</p>
<ul>
<li>数据表 B 的结果集依赖数据表A。</li>
<li>数据表 A 的结果集根据左连接条件依赖所有数据表（B 表除外）</li>
<li>左外连接条件决定如何检索数据表 B(在没有指定 WHERE 条件的情况下)</li>
<li>如果数据表 A 的某条记录符合 WHERE 条件，但是在数据表 B 不存在复合连接条件的记录，将生成一个所有列为空的额外的 B 行。</li>
<li>如果使用内连接查找的记录在连接数据表中不存在，并且在 where 字句中尝试以下操作: 列 IS NULL 时，如果列名称被定义为 NOT NULL, MySQL 将在找到符合连接条件的记录后停止搜索更多行。</li>
</ul>
<h4 id="无限级表设计"><a href="#无限级表设计" class="headerlink" title="无限级表设计"></a>无限级表设计</h4><p>采用自身连接实现，往往表中包含子类和父类信息，但子类中包含了父类的指向，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tdb_goods_types(</span><br><span class="line"> type_id   SMALLINT UNSIGNED PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line"> type_name VARCHAR(20) NOT NULL,</span><br><span class="line"> parent_id SMALLINT UNSIGNED NOT NULL DEFAULT 0</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="DELETE-删除记录-1"><a href="#DELETE-删除记录-1" class="headerlink" title="DELETE 删除记录"></a>DELETE 删除记录</h3><p>多表删除是指，某张表的删除记录依赖于另一张表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DELETE 表名称[.列名称] [,表名称[.列名称]]...</span><br><span class="line">FROM 表名称</span><br><span class="line">[WHERE 条件语句]</span><br></pre></td></tr></table></figure>
<p>应用场景：删除表中的重复数据，用一张表模拟两张表的方法实现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 要删除的记录</span><br><span class="line">SELECT goods_id, goods_name FROM tdb_goods GROUP BY goods_name HAVING count(goods_name) &gt;=2</span><br><span class="line"></span><br><span class="line">// 依赖下表删除上表数据</span><br><span class="line">DELETE t1 FROM tdb_goods AS t1 </span><br><span class="line">LEFT JOIN ( SELECT goods_id, goods_name FROM tdb_goods GROUP BY goods_name HAVING count(goods_name) &gt;=2 ) AS t2 </span><br><span class="line">ON t1.goods_name = t2.goods_name </span><br><span class="line">WHERE t1.goods_id &gt; t2.goods_id</span><br></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/SQL/" rel="tag">#SQL</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/programming/2017-12-03-angular-form-1/" rel="next" title="Angular 表单（一）">
                <i class="fa fa-chevron-left"></i> Angular 表单（一）
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/programming/2017-12-10-sql-2/" rel="prev" title="SQL 基础（二）">
                SQL 基础（二） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="昕小阳" />
          <p class="site-author-name" itemprop="name">昕小阳</p>
          <p class="site-description motion-element" itemprop="description">故事我有，我不喝酒。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">88</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据类型"><span class="nav-number">1.</span> <span class="nav-text">数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#操作数据库"><span class="nav-number">2.</span> <span class="nav-text">操作数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CREATE-创建数据库"><span class="nav-number">2.1.</span> <span class="nav-text">CREATE 创建数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SHOW-查看数据库"><span class="nav-number">2.2.</span> <span class="nav-text">SHOW 查看数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#USE-打开数据库"><span class="nav-number">2.3.</span> <span class="nav-text">USE 打开数据库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#操作数据表"><span class="nav-number">3.</span> <span class="nav-text">操作数据表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建索引"><span class="nav-number">3.1.</span> <span class="nav-text">创建索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建-VIEW"><span class="nav-number">3.2.</span> <span class="nav-text">创建 VIEW</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建数据表"><span class="nav-number">3.3.</span> <span class="nav-text">创建数据表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看数据表"><span class="nav-number">3.4.</span> <span class="nav-text">查看数据表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看数据表结构"><span class="nav-number">3.5.</span> <span class="nav-text">查看数据表结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#记录的查找"><span class="nav-number">3.6.</span> <span class="nav-text">记录的查找</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#记录的插入"><span class="nav-number">3.7.</span> <span class="nav-text">记录的插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#清空记录"><span class="nav-number">3.8.</span> <span class="nav-text">清空记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#空值与非空"><span class="nav-number">3.9.</span> <span class="nav-text">空值与非空</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自动编号"><span class="nav-number">3.10.</span> <span class="nav-text">自动编号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WHERE-子句"><span class="nav-number">3.11.</span> <span class="nav-text">WHERE 子句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BETWEEN"><span class="nav-number">3.11.1.</span> <span class="nav-text">BETWEEN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LIKE"><span class="nav-number">3.11.2.</span> <span class="nav-text">LIKE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IN"><span class="nav-number">3.11.3.</span> <span class="nav-text">IN()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AND-amp-OR"><span class="nav-number">3.11.4.</span> <span class="nav-text">AND & OR</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GROUP-BY"><span class="nav-number">3.11.5.</span> <span class="nav-text">GROUP BY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HAVING"><span class="nav-number">3.11.6.</span> <span class="nav-text">HAVING</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ORDER-BY"><span class="nav-number">3.11.7.</span> <span class="nav-text">ORDER BY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LIMIT"><span class="nav-number">3.11.8.</span> <span class="nav-text">LIMIT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AS"><span class="nav-number">3.11.9.</span> <span class="nav-text">AS</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#约束"><span class="nav-number">4.</span> <span class="nav-text">约束</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NOT-NULL"><span class="nav-number">4.1.</span> <span class="nav-text">NOT NULL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UNIQUE"><span class="nav-number">4.2.</span> <span class="nav-text">UNIQUE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PRIMARY-KEY"><span class="nav-number">4.3.</span> <span class="nav-text">PRIMARY KEY</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FOREIGN-KEY"><span class="nav-number">4.4.</span> <span class="nav-text">FOREIGN KEY</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CHECK"><span class="nav-number">4.5.</span> <span class="nav-text">CHECK</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DEFAULT"><span class="nav-number">4.6.</span> <span class="nav-text">DEFAULT</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改数据表"><span class="nav-number">5.</span> <span class="nav-text">修改数据表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#添加-删除列"><span class="nav-number">5.1.</span> <span class="nav-text">添加/删除列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加-删除约束"><span class="nav-number">5.2.</span> <span class="nav-text">添加/删除约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改列定义"><span class="nav-number">5.3.</span> <span class="nav-text">修改列定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改数据表-1"><span class="nav-number">5.4.</span> <span class="nav-text">修改数据表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#记录操作-－-单表操作"><span class="nav-number">6.</span> <span class="nav-text">记录操作 － 单表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#INSERT-插入记录"><span class="nav-number">6.1.</span> <span class="nav-text">INSERT 插入记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UPDATE-修改记录"><span class="nav-number">6.2.</span> <span class="nav-text">UPDATE 修改记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DELETE-删除记录"><span class="nav-number">6.3.</span> <span class="nav-text">DELETE 删除记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SELECT-查询记录"><span class="nav-number">6.4.</span> <span class="nav-text">SELECT 查询记录</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#记录操作-－-多表操作"><span class="nav-number">7.</span> <span class="nav-text">记录操作 － 多表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#子查询"><span class="nav-number">7.1.</span> <span class="nav-text">子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用比较运算符的子查询"><span class="nav-number">7.1.1.</span> <span class="nav-text">使用比较运算符的子查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用-NOT-IN-的子查询"><span class="nav-number">7.1.2.</span> <span class="nav-text">使用 [NOT] IN 的子查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用-NOT-EXIST-的子查询"><span class="nav-number">7.1.3.</span> <span class="nav-text">使用 [NOT] EXIST 的子查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#INSERT-插入记录-1"><span class="nav-number">7.2.</span> <span class="nav-text">INSERT 插入记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UPDATE-更新记录"><span class="nav-number">7.3.</span> <span class="nav-text">UPDATE 更新记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CREATE…SELECT-创建并更新记录"><span class="nav-number">7.4.</span> <span class="nav-text">CREATE…SELECT 创建并更新记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#连接数据"><span class="nav-number">7.5.</span> <span class="nav-text">连接数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#INNER-JOIN-…-ON"><span class="nav-number">7.5.1.</span> <span class="nav-text">INNER JOIN … ON</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LEFT-JOIN-…-ON-／-RIGHT-JOIN-…-ON"><span class="nav-number">7.5.2.</span> <span class="nav-text">LEFT JOIN … ON ／ RIGHT JOIN … ON</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FULL-JOIN【MYSQL-不支持】"><span class="nav-number">7.5.3.</span> <span class="nav-text">FULL JOIN【MYSQL 不支持】</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CROSS-JOIN"><span class="nav-number">7.5.4.</span> <span class="nav-text">CROSS JOIN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UNION-／-UNION-ALL"><span class="nav-number">7.5.5.</span> <span class="nav-text">UNION ／ UNION ALL</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关于连接的几点说明"><span class="nav-number">7.6.</span> <span class="nav-text">关于连接的几点说明</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#无限级表设计"><span class="nav-number">7.6.1.</span> <span class="nav-text">无限级表设计</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DELETE-删除记录-1"><span class="nav-number">7.7.</span> <span class="nav-text">DELETE 删除记录</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">昕小阳</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
  

  

  

  

  


</body>
</html>
